---
layout: post
title: 关于cdn的基本原理和基础架构
category: 技术
keywords: cdn
---

CDN （content delivery network） 本质上是资源网络集群或者资源服务器，
它能够将资源不断分发到各个节点网络， 当用户访问某个节点的时候，CDN 的距离用户当前网络节点最近的服务器节点，快速返回资源

CDN的步骤如下

1. 用户点击某个资源的URL, 本地DNS服务器进行解析，解析完成后，会将域名的最终解析权交给CNAME指向最近的 CDN 专用 DNS服务器
2. CDN 返回给用户 CDN 负载均衡的IP
3. 用户根据url 请求CDN 负载均衡服务器的IP
4. 负载均衡服务器，会根据用户所在的地址寻找最近的资源服务器，同时还需要判断用户请求的资源在那一台服务器，还有服务器的负载能力等都需要考虑
5. 经过一些列计算后，负载均衡服务器会返回一个缓存资源服务器的IP地址给用户
6. 用户根据该IP 对该缓存资源服务器进行请求访问，如果这台服务器没有用户所需的资源，但是负载均衡服务器依然将这台服务器分配给了用户，那么此时就会向这台资源服务器的上一级查找缓存资源，直到资源的源服务为止以保证最终将资源交给了用户